{% extends "admin_base.html" %}

{% block info %}
    <h3>教师信息表</h3>
    <div class="inf">
        <div>
            <a class="btn btn-primary" id="add_teacher">+ 添加</a>
        </div>
        <br>
        <div class="guodong">
            <table class="table table-hover">
                <tr class="table-primary">
                    <td>工&nbsp&nbsp&nbsp号</td>
                    <td>姓&nbsp&nbsp&nbsp名</td>
                    <td>性&nbsp&nbsp&nbsp别</td>
                    <td>身&nbsp&nbsp份&nbsp&nbsp证&nbsp&nbsp号</td>
                    <td>电&nbsp&nbsp&nbsp话</td>
                    <td>操&nbsp&nbsp&nbsp作</td>
                </tr>
                {% for info in tea_list %}
                    <tr>
                        <td>{{ info.tid }}</td>
                        <td>{{ info.name }}</td>
                        <td>
                            {% if info.sex == "1" %}
                                男
                            {% else %}
                                女
                            {% endif %}
                        </td>
                        <td>{{ info.id }}</td>
                        <td>{{ info.phone }}</td>
                        <td>
                            <a class="btn btn-primary table_alter_info">修改</a>
                            <a class="btn btn-danger" href="del_teacher?tid={{ info.tid }}">删除</a>
                        </td>
                    </tr>
                {% endfor %}
            </table>
        </div>
    </div>
{% endblock %}

{% block windnows %}
    <div id='shadow' class="shadow hide"></div>
    <div id='add_teacher_info' class="modal1 hide">
        <div style="padding: 0 10px;">
            <h3 style="margin-top: 10px;">添加教师信息</h3>
            <br>
            <form>
                <div class="input-group mb-3" style="padding: 0 20px;">
                    <div class="input-group-prepend">
                        <span class="input-group-text" id="inputGroup-sizing-default">工号</span>
                    </div>
                    <input id='add_tid' type="text" class="form-control" name="add_tid" placeholder="工号"
                           aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default"/>
                </div>
                <div class="input-group mb-3" style="padding: 0 20px;">
                    <div class="input-group-prepend">
                        <span class="input-group-text" id="inputGroup-sizing-default">姓名</span>
                    </div>
                    <input id='add_tname' type="text" class="form-control" name="add_tname" placeholder="姓名"
                           aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default"/>
                </div>
                <div class="input-group mb-3" style="padding: 0 20px;">
                    <div class="input-group-prepend">
                        <span class="input-group-text" id="inputGroup-sizing-default">性别</span>
                    </div>
                    <input id='add_sex' type="text" class="form-control" name="add_sex" placeholder="性别"
                           aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default"/>
                </div>
                <div class="input-group mb-3" style="padding: 0 20px;">
                    <div class="input-group-prepend">
                        <span class="input-group-text" id="inputGroup-sizing-default">身份证号</span>
                    </div>
                    <input id='add_id' type="text" class="form-control" name="add_id" placeholder="身份证号"
                           aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default"/>
                </div>
                <div class="input-group mb-3" style="padding: 0 20px;">
                    <div class="input-group-prepend">
                        <span class="input-group-text" id="inputGroup-sizing-default">电话</span>
                    </div>
                    <input id='add_phone' type="text" class="form-control" name="add_phone" placeholder="电话"
                           aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default"/>
                </div>
            </form>
            <input id="btnAdd" class="bttn bttn-primary" type="button" value="添加"/>
            <input class="btnCancel bttn bttn-secondary" type="button" value="取消"/>
            <span id="errormsg" style="color: #ff0000"></span>
        </div>
    </div>

    <div id='shadow' class="shadow hide"></div>
    <div id='alter_teacher_info' class="modal1 hide">
        <div style="padding: 0 10px;">
            <h3 style="margin-top: 10px;">修改教师信息</h3>
            <br>
            <form>
                <div class="input-group mb-3" style="padding: 0 20px;">
                    <div class="input-group-prepend">
                        <span class="input-group-text" id="inputGroup-sizing-default">工号</span>
                    </div>
                    <input id='alter_tid' type="text" class="form-control" name="alter_tid" placeholder="工号"
                           aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default"/>
                </div>
                <div class="input-group mb-3" style="padding: 0 20px;">
                    <div class="input-group-prepend">
                        <span class="input-group-text" id="inputGroup-sizing-default">姓名</span>
                    </div>
                    <input id='alter_tname' type="text" class="form-control" name="alter_tname" placeholder="姓名"
                           aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default"/>
                </div>
                <div class="input-group mb-3" style="padding: 0 20px;">
                    <div class="input-group-prepend">
                        <span class="input-group-text" id="inputGroup-sizing-default">性别</span>
                    </div>
                    <input id='alter_sex' type="text" class="form-control" name="alter_sex" placeholder="性别"
                           aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default"/>
                </div>
                <div class="input-group mb-3" style="padding: 0 20px;">
                    <div class="input-group-prepend">
                        <span class="input-group-text" id="inputGroup-sizing-default">身份证号</span>
                    </div>
                    <input id='alter_id' type="text" class="form-control" name="alter_id" placeholder="身份证号"
                           aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default"/>
                </div>
                <div class="input-group mb-3" style="padding: 0 20px;">
                    <div class="input-group-prepend">
                        <span class="input-group-text" id="inputGroup-sizing-default">电话</span>
                    </div>
                    <input id='alter_phone' type="text" class="form-control" name="alter_phone" placeholder="电话"
                           aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default"/>
                </div>
            </form>
            <input id="btnAlter" class="bttn bttn-primary" type="button" value="修改"/>
            <input class="btnCancel bttn bttn-secondary" type="button" value="取消"/>
            <span id="errormsg" style="color: #ff0000"></span>
        </div>
    </div>
{% endblock %}

{% block js %}
    <script src="/static/js/jquery-2.2.4.min.js"></script>
    <script>
        $(function () {
            click_add_teacher();
            add_teacher();
            click_alter();
            alter();
            cancel();
        })

        function click_add_teacher(){
            $("#add_teacher").click(function (){
                $("#shadow").removeClass("hide");
                $("#add_teacher_info").removeClass("hide");

                $('#add_tid').val('');
                $('#add_tname').val('');
                $('#add_sex').val('');
                $('#add_id').val('');
                $('#add_phone').val('');

            });
        }

        function add_teacher(){
            $("#btnAdd").click(function (){
                $.ajax({
                    url: '/system_admin/add_teacher',
                    type: 'post',
                    data: {'tid': $('#add_tid').val(), 'tname': $('#add_tname').val(),'sex': $('#add_sex').val(),
                    'id': $('#add_id').val(),'phone': $('#add_phone').val(),},
                    dataType: 'JSON',
                    success: function (arg) {

                        if (arg.status) {
                            location.reload();
                        } else {
                            $('#errormsg').text(arg.message);
                        }
                    }
                });
            });
        }

        function click_alter() {
            $(".table_alter_info").click(function () {
                $("#shadow").removeClass("hide");
                $("#alter_teacher_info").removeClass("hide");

                var row = $(this).parent().prevAll();

                var tid = $.trim($(row[4]).text());
                var tname = $.trim($(row[3]).text());
                var sex = $.trim($(row[2]).text());
                var id = $.trim($(row[1]).text());
                var phone = $.trim($(row[0]).text());

                $('#alter_tid').val(tid);
                $('#alter_tname').val(tname);
                $('#alter_sex').val(sex);
                $('#alter_id').val(id);
                $('#alter_phone').val(phone);
            });
        }

        function alter() {
            $('#btnAlter').click(function () {
                $.ajax({
                    url: '/system_admin/alter_teacher',
                    type: 'post',
                    data: {'tid': $('#alter_tid').val(), 'tname': $('#alter_tname').val(),'sex': $('#alter_sex').val(),
                    'id': $('#alter_id').val(),'phone': $('#alter_phone').val(),},
                    dataType: 'JSON',
                    success: function (arg) {

                        if (arg.status) {
                            location.reload();
                        } else {
                            $('#errormsg').text(arg.message);
                        }
                    }
                });
            });
        }

        function cancel() {
            $('.btnCancel').click(function () {
                $('#shadow,#add_teacher_info').addClass('hide');
                $('#shadow,#alter_teacher_info').addClass('hide');
            });
        }

    </script>
{% endblock %}